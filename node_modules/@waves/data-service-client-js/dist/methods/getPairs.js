"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var data_entities_1 = require("@waves/data-entities");
var createMethod_1 = require("./createMethod");
var createRequest_1 = require("../createRequest");
var isAssetPair = function (pair) {
    switch (true) {
        case typeof pair === 'string':
            return pair.split('/').length === 2;
        case typeof pair === 'object':
            return data_entities_1.AssetPair.isAssetPair(pair);
        default:
            return false;
    }
};
var isValidPairsFilters = function (request) {
    return (Array.isArray(request) &&
        request.length === 2 &&
        typeof request[0] === 'string' &&
        (Array.isArray(request[1]) ? request[1] : [request[1]]).every(isAssetPair));
};
var validateRequest = function (matcher) { return function (pairs) {
    var request = [matcher, pairs];
    return isValidPairsFilters(request)
        ? Promise.resolve(request)
        : Promise.reject(new Error('ArgumentsError: AssetPair should be object with amountAsset, priceAsset'));
}; };
var createRequestForMany = function (nodeUrl) { return function (_a) {
    var matcher = _a[0], pairs = _a[1];
    return createRequest_1.createRequest(nodeUrl + "/pairs", {
        pairs: pairs.map(function (p) { return p.toString(); }),
        matcher: matcher,
    });
}; };
var getPairs = function (libOptions) { return function (matcher) {
    return createMethod_1.createMethod({
        validate: validateRequest(matcher),
        generateRequest: createRequestForMany,
        libOptions: libOptions,
    });
}; };
exports.default = getPairs;
