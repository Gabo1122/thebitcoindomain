var workerWrapper=function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=4)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this._constructorList=[],this._classes=[]}var t;return e.prototype.serialize=function(t){var r=this,n={data:null,classes:this._classes},a=function(t){switch(typeof t){case"function":return e.isFunction(t)?{__type:"serialized-function",template:e.functionToString(t)}:{__type:"serialized-class",index:r._addConstructor(t)};case"object":if(!t)return t;if(e.isInstance(t))return{__type:"serialized-instance",index:r._addConstructor(t.constructor),data:t};if(e.isNative(t.constructor)&&!["Object","Array"].includes(t.constructor.name))return{__type:"serialized-native-instance",constructorName:t.constructor.name,data:t};if(Array.isArray(t))return t.map(a);var n=Object.create(null);return Object.entries(t).forEach(function(e){var t=e[0],r=e[1];n[t]=a(r)}),n;default:return t}};return n.data=a(t),this._clear(),n},e.prototype._addConstructor=function(t){var r=this,n=this._constructorList.indexOf(t);return-1===n?(e.getFullClassTemplate(t).forEach(function(e,t,n){if(-1===r._constructorList.indexOf(e.factory)){var a=n[t-1]?r._classes.length-1:void 0;r._constructorList.push(e.factory),r._classes.push({template:e.template,name:e.name,parent:a})}}),this._constructorList.length-1):n},e.prototype._clear=function(){this._classes=[],this._constructorList=[]},e.isNative=function(e){return/function .*\(\).*\n?.*\[native code\]/.test(e.toString())},e.isInstance=function(t){var r=t.constructor;return!!r&&!e.isNative(r)},e.getClassParents=function(e){for(var t=[e],r=e,n=Object.getPrototypeOf(r);n.prototype;)t.push(n),r=n,n=Object.getPrototypeOf(r);return t.reverse()},e.isFunction=function(t){return!t.prototype||0===Object.getOwnPropertyNames(t.prototype).filter(function(e){return"constructor"!==e}).length&&1===e.getClassParents(t).length},e.functionToString=function(e){return"(function () {\n   return "+e.toString()+"\n})();"},e.getFullClassTemplate=function(t){return e.getClassParents(t).map(function(t){return e._getClassData(t)}).map(function(t,r,n){var a=n[r-1];return{name:t.Name,template:e._getClassTemplate(t,a),factory:t.Factory}})},e.getFnName=function(e){var t=e.name&&["",e.name]||e.toString().match(/function ([^\(]+)/);return t&&t[1]||null},e.getFnNameForce=function(t){return e.getFnName(t)||e._getUniqFunctionName()},e._getClassData=function(t){return t?{Name:e.getFnNameForce(t),Factory:t}:void 0},e._getClassTemplate=function(t,r){var n=r&&r.Name||void 0;return["(function () { ",e._getConstructorTemplate(t.Factory,t.Name,n),e._getPrototypeTemplate(t.Factory,t.Name,n),e._getStaticTemplate(t.Factory,t.Name),"return "+t.Name+"; })();"].join("\n")},e._getConstructorTemplate=function(t,r,n){var a=["var "+r+" = "+e._replaceSuper(t,n)+";"];return n&&(a.push(r+".prototype = Object.create("+n+".prototype);"),a.push(r+".prototype.constructor = "+r+";")),a.join("\n")},e._getPrototypeTemplate=function(t,r,n){return Object.entries(t.prototype).filter(function(e){return"constructor"!==e[0]}).reduce(function(t,a){var i=a[0],s=a[1];return t+"\n"+e._getPrototypeItemTemplate(s,i,r,n)},"")},e._getStaticTemplate=function(t,r){return Object.entries(t).reduce(function(t,n){var a=n[0],i=n[1];return t+"\n"+e._getStaticItemTemplate(i,a,r)},"")},e._getPrototypeItemTemplate=function(t,r,n,a){switch(typeof t){case"object":return n+".prototype."+r+" = "+JSON.stringify(t)+";";case"function":return n+".prototype."+r+" = "+e._replaceSuper(t,a)+";";default:return n+".prototype."+r+" = "+t+";"}},e._getStaticItemTemplate=function(e,t,r){switch(typeof e){case"object":return r+"."+t+" = "+JSON.stringify(e)+";";case"function":return r+"."+t+" = "+e.toString()+";";default:return r+"."+t+" = "+e+";"}},e._replaceSuper=function(t,r){return r?t.toString().replace(e._getSuperReg(),""+r):t.toString()},e._getSuperReg=function(){return/\b(_super)\b/g},e._getUniqFunctionName=(t=0,function(){return"Unnamed_"+t++}),e}();t.Serializer=n},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),i=r(2),s=function(){function e(e,t,r,n){var s=this;this._worker=e,this._actionsHash=Object.create(null),this._stringifyMode=null!=n&&n,this._serializer=new a.Serializer,this._parser=new i.Parser,this._setHandlers(),this._ready=Promise.all([this._addLibs(r),this._addProcessor(t)]).then(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.every(Boolean)}).catch(function(e){throw s.terminate(),console.error(e),new Error(e)})}return e.prototype.process=function(e,t){var r=this;return this._ready.then(function(){return r._sendMessage({type:2,params:r._serializer.serialize(t),job:r._serializer.serialize(e)})})},e.prototype.terminate=function(){var e=this;Object.keys(this._actionsHash).forEach(function(t){e._actionsHash[t].reject("Worker was terminated!"),delete e._actionsHash[t]}),this._worker.terminate()},e.prototype._setHandlers=function(){var e=this;this._worker.onmessage=function(t){e._onMessage(t.data)}},e.prototype._onMessage=function(e){if(this._stringifyMode&&(e=JSON.parse(e)),!e.id)throw new Error(e);var t=e.state?"resolve":"reject";this._actionsHash[e.id][t](this._parser.parse(e.body)),delete this._actionsHash[e.id]},e.prototype._sendMessage=function(e){var t=this,r=Date.now()+"-"+Math.random();return new Promise(function(n,a){t._actionsHash[r]={resolve:n,reject:a};try{t._worker.postMessage(t._getSendData(e,r))}catch(e){console.error(e),a(e)}})},e.prototype._getSendData=function(e,t){var r=n({},e,{id:t});return this._stringifyMode?JSON.stringify(r):r},e.prototype._addLibs=function(e){return e&&e.length?this._sendMessage({type:0,libs:e.map(function(e){var t=(location.host+"/"+e).replace("//","/");return location.protocol+"//"+t})}):Promise.resolve(!0)},e.prototype._addProcessor=function(e){return e&&e.child?this._sendMessage({type:1,codeData:this._serializer.serialize(e.child),params:this._serializer.serialize(e.params)}):Promise.resolve(!0)},e}();t.Wrap=s},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Parser=function(){function Parser(){this._classes=Object.create(null)}return Parser.prototype.parse=function(e){var t=this;this._addClassData(e.classes);var r=function(n){return Parser._isSerializedField(n)?t._parseSerializedItem(n,e.classes):Array.isArray(n)?n.map(r):n?"object"!=typeof n?n:Object.entries(n).reduce(function(e,t){var n,a=t[0],i=t[1];return Object.assign(e,((n={})[a]=r(i),n))},{}):n};return r(e.data)},Parser.prototype._parseSerializedItem=function(e,t){switch(e.__type){case"serialized-native-instance":return e.data;case"serialized-class":return this._classes[t[e.index].template].Factory;case"serialized-function":return Parser._compile(e.template);case"serialized-instance":return Parser._parseInstance(e.data,this._classes[t[e.index].template].Factory)}},Parser.prototype._addClassData=function(e){var t=this;e.forEach(function(e,r,n){if(!(t._classes[e.template]||e.name in self&&e.template===self[e.name].constructor.toString())){var a=null!=e.parent&&n[e.parent]||void 0;t._compileClass(e,a)}})},Parser.prototype._compileClass=function(classData,parent){var needReplace=parent&&parent.name in self&&parent.template!==self[parent.name].constructor.toString(),hasValue=!parent||parent.name in self,parentOrigin=needReplace&&self[parent.name];hasValue&&!needReplace||(self[parent.name]=this._classes[parent.template].Factory);var Factory=eval("(function () { return "+classData.template+" })();");needReplace&&(self[parent.name]=parentOrigin),this._classes[classData.template]={name:classData.name,Factory:Factory}},Parser._parseInstance=function(e,t){var r=Object.create(t.prototype);return Object.assign(r,e),r},Parser._isSerializedField=function(e){return"object"==typeof e&&e&&"__type"in e&&-1!==["serialized-native-instance","serialized-function","serialized-class","serialized-instance"].indexOf(e.__type)},Parser._compile=function(code){var template="(function () { return "+code+" })();";return eval(template)},Parser}();exports.Parser=Parser},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(t,r,n){e.Serializer=t,e.Parser=r,this._serializer=new e.Serializer,this._parser=new e.Parser,this._stringifyMode=n,this.setHandlers()}return e.prototype.setHandlers=function(){var e=this;self.onmessage=function(t){e.onMessage(e._stringifyMode?JSON.parse(t.data):t.data)}},e.prototype.onMessage=function(e){var t=this;switch(e.type){case 0:this.process(function(){return t.addLibs(e.libs)},e.id);break;case 1:this.process(function(){return t.addProcessor(e)},e.id);break;case 2:this.doWork(e)}},e.prototype.addLibs=function(e){e.forEach(function(e){return self.importScripts(e)})},e.prototype.addProcessor=function(t){var r=this._parser.parse(t.params),n=this._parser.parse(t.codeData);e.Serializer.isFunction(n)?this.child=n(r):this.child=new n(r)},e.prototype.process=function(e,t){try{e(),this.send({id:t,state:!0,body:null})}catch(e){this.send({id:t,state:!1,body:String(e)})}},e.prototype.send=function(e){e.body=this._serializer.serialize(e.body);try{self.postMessage(this._stringifyMode?JSON.stringify(e):e)}catch(r){var t={id:e.id,state:!1,body:String(r)};self.postMessage(this._stringifyMode?JSON.stringify(t):t)}},e.prototype.doWork=function(e){var t=this;try{var r=this._parser.parse(e.job),n=this._parser.parse(e.params),a=this.child?r(this.child,n):r(n);a&&a.then&&"function"==typeof a.then?a.then(function(r){t.send({id:e.id,state:!0,body:r})},function(r){r instanceof Error&&(r=String(r)),t.send({id:e.id,state:!1,body:r})}):this.send({id:e.id,state:!0,body:a})}catch(t){this.send({id:e.id,state:!1,body:String(t)})}},e}();t.WorkerBody=n},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function a(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0});var i=r(3),s=r(0),o=r(1),c=r(2);a(r(3)),a(r(0)),a(r(2)),a(r(1)),a(r(1));var u=new(function(){function e(){this._options={libs:[],customWorker:i.WorkerBody,stringifyMode:!1}}return e.prototype.config=function(e){this._options=n({},this._options,e)},e.prototype.getConfig=function(){return n({},this._options)},e.prototype.create=function(e,t,r){var a,i,s;"function"==typeof e?a=e:this._isConfig(e)&&(i=e),t&&(this._isConfig(t)?i=t:(s=t,r&&(i=r))),i=i||Object.create(null);var c=n({},this._options,i),u=this._createWorker(c.customWorker,c.stringifyMode);return new o.Wrap(u,{child:a,params:s},c.libs,c.stringifyMode)},e.prototype._createWorker=function(e,t){var r="var MyWorker = "+this._createTemplate(e,t)+";",n=new Blob([r],{type:"application/javascript"});return new Worker(URL.createObjectURL(n))},e.prototype._createTemplate=function(e,t){if(!s.Serializer.getFnName(e))throw new Error("Unnamed Worker Body class! Please add name to Worker Body class!");return["(function () {",this._getFullClassTemplate(s.Serializer,"Serializer"),this._getFullClassTemplate(c.Parser,"Parser"),this._getFullClassTemplate(e,"WorkerBody"),"return new WorkerBody(Serializer, Parser, "+!!t+")})();"].join("\n")},e.prototype._getFullClassTemplate=function(e,t){return s.Serializer.getFullClassTemplate(e).reduce(function(e,r){return"var "+t+" = "+r.template},"")},e.prototype._isConfig=function(e){var t=this,r=e&&Object.keys(e)||[];return!!r.length&&r.every(function(r){return!!t._options[r]&&typeof e[r]==typeof t._options[r]&&Array.isArray(e[r])===Array.isArray(t._options[r])})},e}());t.create=function(e,t){return u.create(e,t)},t.getConfig=function(){return u.getConfig()},t.config=function(e){return u.config(e)}}]);